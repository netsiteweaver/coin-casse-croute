function getVersionHistory(e){void 0!==e&&null!=e||(e=1),$("#modal-overlay").removeClass("hidden"),$("#version-history-modal").modal("show"),$("#commit-history tbody").empty(),$.ajax({url:base_url+"ajax/misc/getHistory/"+e,dataType:"JSON",success:function(e){e.result?($(e.commits).each(function(e,t){var o="<tr>";o+="<td>"+t.details+"</td>",o+="<td>"+t.date+"</td>",void 0!==t.author&&(o+="<td>"+t.author+"</td>"),o+="</tr>",$("#commit-history tbody").append(o)}),$(".pagination").html(e.pagination),$("#modal-overlay").addClass("hidden")):"login"==e.reason&&($("#version-history-modal").modal("hide"),$("#login-modal").modal("show"))}})}function toggleFullScreen(){document.fullScreenElement&&null!==document.fullScreenElement||!document.mozFullScreen&&!document.webkitIsFullScreen?document.documentElement.requestFullScreen?document.documentElement.requestFullScreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullScreen&&document.documentElement.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()}function Notify(e){null!=e&&0!=e.length||(e="error-sound"),null!==document.getElementById(e)&&document.getElementById(e).play()}function addCommas(e){e+="";for(var t=e.split("."),o=t[0],a=t.length>1?"."+t[1]:"",n=/(\d+)(\d{3})/;n.test(o);)o=o.replace(n,"$1,$2");return o+a}function tableSort(e,t,o,a){console.log("Sorting "+e+" Init...");var n=!0;if(void 0===e&&(n=!1),void 0!==t&&""!=t||(n=!1),!n)return alert("Error"),!1;void 0===o&&(o="id"),void 0===a&&(a="display_order"),$(e).addClass("cursor-sort");var s=function(e,t){return t.children().each(function(){$(this).width($(this).width())}),t};$(e+" tbody").sortable({helper:s}).disableSelection(),$(e+" tbody").on("sortstop",function(n,s){let r=[],l=0;$(e+" tbody tr").each(function(e,t){l+=1,r.push({[o]:$(this).data("id"),[a]:l}),$(this).find(".display_order").addClass("value_updated").text(l)}),console.log(r),$.ajax({url:base_url+"ajax/misc/reorder",method:"POST",data:{data:JSON.stringify(r),primary_key:o,display_order_field:a,table_name:t},success:function(e){toastr.info("Rows have bee successfully re-ordered.")},complete:function(){}})})}function Search(e,t){let o=$("#"+e);if(null===o||0==o.length){let e="<div class='row'><div class='col-md-4'><input class='form-control searchText' placeholder='START TYPING...' id='searchText' autofocus></div></div>";$("#"+t).closest(".row").before(e)}$("#"+t+" tr:gt(0)").addClass(function(e){return"searchTR"}),$("body").on("keyup","#"+e,function(){var e=$(this).val().toLowerCase();$("#"+t+" tr.searchTR").filter(function(){$(this).toggle($(this).text().toLowerCase().indexOf(e)>-1)})})}function Overlay(e){void 0===e&&(e="on"),e=e.toLowerCase();let t=["on","off"];t.includes(e)||(e="on"),"on"==e?$("#overlay").removeClass("hidden"):$("#overlay").addClass("hidden")}function Processing(e,t,o,a,n){if(console.log(),null==e)return console.log("no object"),!1;if(void 0===t)return console.log("no state passed"),!1;void 0===o&&(o="Processing"),void 0===a&&(a="<i class='fa fa-save'></i> Save"),void 0===n&&(n="<i class='fa fa-spin fa-spinner'></i> "+o);let s=["on","off"];if(t=t.trim().toLowerCase(),-1==s.indexOf(t))return!1;"on"==t?$(e).html(n):$(e).html(a)}function formValidation(e){var t=!0,o="",a=!1;return $(e).find(".required").each(function(){var e=$(this).val(),n=$(this).data("name"),s=$(this).data("errormessage");$(this).parent().remove(".error_notes"),null==n&&(n=$(this).attr("name")),null==s&&(s=""),void 0!==e&&null!=e&&0==e.length&&($(this).addClass("error"),$(this).parent().find("p.error_notes").remove(),$(this).parent().append("<p class='error_notes'><b><u>"+n+"</u></b> is compulsory. "+s+"</p>"),t=!1,0==a&&(a=$(this)),o+=o+n+" is required.<br> ")}),0==t&&($("html, body").animate({scrollTop:$(a).offset().top-25}),$(a).focus(),Notify(),toastr.error("Please correct the errors highlighted and try again")),t}function update_dashboard(){$.ajax({url:base_url+"ajax/misc/dashboard_update",method:"GET",dataType:"JSON",success:function(e){e.result&&($("#expenses").text("Rs "+e.totals.totalExpenses.toLocaleString("US-en")),$("#deliveries").html(e.totals.totalDelivered+" / "+(null==e.totals.totalItems?"0":e.totals.totalItems)+" ITEMS"),$("#orders").html("Rs "+e.totals.totalSalesDelivered),$("#delivery_details_container").empty(),$(e.deliveryBoys).each(function(e,t){let o=$(".delivery_details.hidden").clone().removeClass("hidden");$(o).attr("id",t.delivery_boy),$(o).find(".delivery-boy").html(t.name),$(o).find(".delivered").html(void 0===t.delivered?"0":t.delivered),$(o).find(".undelivered").html(void 0===t.undelivered?"0":t.undelivered),$(o).find(".items").html(void 0===t.total_item?"0":t.total_item);var a="",n=0;$(t.split).each(function(e,t){n+=parseFloat(t.amt),a+="<div class='row'><div class='col-xs-5 col-xs-offset-1'><h5 class='text-bold'>"+t.pm+"</h5></div><div class='col-xs-4'><h5>: "+parseFloat(t.amt).toLocaleString("en-US")+"</h5></div></div>"}),a+="<div class='row totals'><div class='col-xs-5 col-xs-offset-1'><h5 class='text-bold'>TOTAL</h5></div><div class='col-xs-4'><h5>: "+n.toLocaleString("en-US")+"</h5></div></div>",$(o).find(".split-payments").html(a),$("#delivery_details_container").append(o)}))}})}function init(){}function myAlert(e){alertify.alert("Lemon Yellow System",e)}function includeJs(e){var t=document.createElement("script");t.type="text/javascript",t.src=e,document.body.appendChild(t)}function ringBell(){null!==document.getElementById("ding")&&document.getElementById("ding").play()}function Filter(e,t,o){0==t.length?$("table#"+e+" tbody tr").show():$("table#"+e+" tbody tr").hide(),$("table#"+e+" tbody tr").each(function(e,a){var n=!1;$(this).find(o).each(function(){var e=$(this).text().toLowerCase();n=e.indexOf(t)>=0}),n&&(console.log("found"),$(this).show())})}function myloader(e){"on"==e?$(".myloader").removeClass("d-none"):$(".myloader").addClass("d-none")}function hide(e){Array.isArray(e)?$(e).each(function(e,t){$(t).addClass("d-none")}):$(e).addClass("d-none")}function unhide(e){Array.isArray(e)?$(e).each(function(e,t){$(t).removeClass("d-none")}):$(e).removeClass("d-none")}function show(e){unhide(e)}$("ul.treeview-menu>li.active").closest(".treeview").addClass("menu-open"),$("ul.treeview-menu>li.active").closest(".treeview").addClass("active");var GlobalFormStatus=!0,latest_logins_id=0,latest_orders_id=0,deviceInfo=navigator;$(document).ready(function(){function e(){var e=!0,t="",o=!1;return $(".required").each(function(){var a=$(this).val(),n=$(this).data("name"),s=$(this).data("errormessage");$(this).parent().remove(".error_notes"),null==n&&(n=$(this).attr("name")),null==s&&(s=""),void 0!==a&&null!=a&&0==a.length&&($(this).addClass("error"),$(this).parent().append("<p class='error_notes'><b><u>"+n+"</u></b> is compulsory. "+s+"</p>"),e=!1,0==o&&(o=$(this)),t+=t+n+" is required.<br> ")}),0==e&&($("html, body").animate({scrollTop:$(o).offset().top-25}),$(o).focus(),Notify(),toastr.error("Please correct the errors highlighted and try again")),e}$.fn.swapClass=function(e,t){this.removeClass(e).addClass(t)},init(),$("footer.footer").html(deviceInfo.userAgent),$("body").on("keydown",function(e){if("Escape"==e.key&&e.originalEvent.target.className.includes("searchText")&&$(".searchText").val(""),"Enter"==e.key||13==e.keyCode){if(console.log(e.originalEvent.target.className),e.originalEvent.target.className.includes("message-to-send"))return!1;if(e.originalEvent.target.className.includes("message-to-send"))return!1}}),$("#version-history").on("click",function(){getVersionHistory()}),$("#version-history-modal").on("click",".pagination a",function(e){e.preventDefault();let t=$(this).text();getVersionHistory(t)}),$("input[type=number]").on("keydown",function(e){console.log($(this).val())}),$(".print").on("click",function(){let e=$(this).data("url");console.log(e),window.print(),void 0!==e&&(window.location.href=base_url+e)}),$(".select2").select2(),$(".summernote").summernote({callbacks:{onPaste:function(e){var t=((e.originalEvent||e).clipboardData||window.clipboardData).getData("Text");console.log(t),e.preventDefault(),t=t.replace(/\r?\n/g,"<br>"),document.execCommand("insertHtml",!1,t)}},height:250,tabsize:4,placeholder:"Enter text here ...",toolbar:[["style",["bold","italic","underline","clear"]],["font",["strikethrough","superscript","subscript"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["view",["fullscreen","codeview"]]]}),toastr.options={closeButton:!1,debug:!1,newestOnTop:!0,progressBar:!0,preventDuplicates:!1,onclick:null,showDuration:"100",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut",positionClass:"toast-bottom-right"},flashSuccess.length>0&&(toastr.success(flashSuccess),window.setTimeout(function(){$("div.alert.alert-success").fadeOut(5e3)},2500)),flashDanger.length>0&&(toastr.error(flashDanger),window.setTimeout(function(){$("div.alert.alert-danger").fadeOut(5e3)},2500)),$("input[type=number]").each(function(){var e=$(this).val(),t=$(this).attr("min");$(this).hasClass("text-right")||$(this).addClass("text-right"),void 0===t&&(t=0),0==e.length&&$(this).val(t)}),$(".numeric").on("focus",function(){var e=$(this).val().replace(/'/g,"");$(this).val(e)}),$(".numeric").on("blur",function(){var e=$(this).val();$(this).val(numeral(e).format("0,0.00"))}),$(".required").each(function(){var e=$(this).parent().find("label");0==e.length?$(this).parent().parent().find("label").addClass("asterisk"):$(this).parent().find("label").addClass("asterisk")}),$("form").submit(function(t){if(!$(this).hasClass("ignoreValidation")){$(".error").removeClass("error"),$("p.error_notes").remove();var o=e();return GlobalFormStatus=o,console.log(o,GlobalFormStatus),!(!o||!GlobalFormStatus)&&void 0}}),$("button.delete, .delete2").on("click",function(e){e.preventDefault();var t=$(this).data("message"),o=$(this).data("url");if(void 0===o||0==o.length)o=$(this).parent().attr("href");return Notify("error-sound"),null==t&&(t="Are you sure you want to delete this record?"),bootbox.confirm({message:t,buttons:{confirm:{label:"Yes, Delete It !",className:"btn-danger"},cancel:{label:"No",className:"btn-primary"}},callback:function(e){}}),!1}),$("body").on("click",".deleteAjax",function(e){e.preventDefault();var t=$(this),o=$(this).data("message"),a=$(this).data("message_complete"),n=$(this).data("id"),s=$(this).data("pk"),r=$(this).data("uuid"),l=$(this).data("url");return null==o&&(o="Are you sure you want to delete this record?"),null==a&&(a="Record has been deleted."),Notify("error-sound"),bootbox.confirm({message:o,buttons:{confirm:{label:"Yes",className:"btn-danger"},cancel:{label:"No",className:"btn-primary"}},callback:function(e){1==e?$.ajax({url:l,type:"POST",dataType:"JSON",data:{id:n,uuid:r,pk:s},success:function(e){console.log(e),t.closest("tr").remove(),toastr.warning(a)}}):toastr.info("Deletion Cancelled")}}),!1}),$("body").on("click",".delete_row",function(e){e.preventDefault();var t=$(this),o=$(this).data("message"),a=$(this).data("message_complete"),n=$(this).data("id"),s=$(this).data("uuid"),r=$(this).data("pk"),l=$(this).data("table");return null==o&&(o="Are you sure you want to delete this record?"),null==a&&(a="Record has been deleted."),Notify("error-sound"),bootbox.confirm({message:o,buttons:{confirm:{label:"Yes",className:"btn-danger"},cancel:{label:"No",className:"btn-primary"}},callback:function(e){1==e?$.ajax({url:base_url+"ajax/misc/delete",type:"POST",dataType:"JSON",data:{id:n,uuid:s,table:l,pk:r},success:function(e){console.log(e),t.closest("tr").remove(),toastr.info(a)}}):toastr.info("Deletion Cancelled")}}),!1}),$("button.deleteImage").on("click",function(e){return $(this).parent().parent().find(".uploadImage").removeClass("hidden"),$(this).parent().addClass("hidden"),!1}),$(".delete").on("click",function(){return alert("Function has been disabled"),!1}),$(".onFocusInput").on("focus",function(){$(this).closest(".form-group").find(".onFocusNotes").removeClass("hidden")}),$(".onFocusInput").on("blur",function(){$(this).closest(".form-group").find(".onFocusNotes").addClass("hidden")}),$("#view-issues").on("click",function(){$("#issuesModal").modal("show")}),$("#modal-signin").on("click",function(){let e=!0,t=$("input[name=modal-email]").val(),o=$("input[name=modal-password]").val();if($(".has-error").removeClass("has-error"),0==t.length&&($("input[name=modal-email]").closest(".form-group").addClass("has-error"),e=!1),0==o.length&&($("input[name=modal-password]").closest(".form-group").addClass("has-error"),e=!1),!e)return!1;$.ajax({url:base_url+"users/authenticate",type:"POST",dataType:"JSON",data:{inputEmail:$("input[name=modal-email]").val(),inputPassword:$("input[name=modal-password]").val()},success:function(e){0==e.result?($("#signin").removeClass("hidden"),$("#result").addClass("alert alert-danger").text(e.reason)):(toastr.success("Success"),$("#login-modal").modal("hide"),setTimeout(function(){getVersionHistory()},500))},error:function(){$("#result").addClass("alert alert-danger").text("1200: An error has occurred")}})}),$("table.table").each(function(e,t){let o="";$(this).hasClass("table-no-border")||(o+="table-bordered "),$(this).hasClass("table-not-condensed")||(o+="table-condensed "),$(this).hasClass("table-not-striped")||(o+="table-striped "),$(this).addClass(o)})}),String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.ucwords=function(){return str=this.toLowerCase(),str.replace(/(^([a-zA-Z\p{M}]))|([ -][a-zA-Z\p{M}])/g,function(e){return e.toUpperCase()})};